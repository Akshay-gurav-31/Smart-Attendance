<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Registration & Embedding Test</title>
</head>
<body>
  <h2>Student Registration</h2>

  <form id="studentForm">
    <label>Student ID:</label>
    <input type="text" id="student_id" required /><br/><br/>

    <label>Upload Photos (Multiple):</label>
    <input type="file" id="photos" multiple accept="image/*" required /><br/><br/>

    <button type="submit">Register</button>
  </form>

  <h3 id="result"></h3>

  <script>
    document.getElementById("studentForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData();
      formData.append("student_id", document.getElementById("student_id").value);

      const files = document.getElementById("photos").files;
      for (let i = 0; i < files.length; i++) {
        formData.append("photos", files[i]);
      }

      const resultEl = document.getElementById("result");
      resultEl.innerText = "Processing...";

      try {
        const response = await fetch("http://localhost:8000/api/detect-and-embed", {
          method: "POST",
          body: formData
        });

        const result = await response.json();
        if (result.error) {
          resultEl.innerText = "Error: " + result.error;
        } else {
          resultEl.innerText = `
Student ID: ${result.student_id}
Faces Detected: ${result.faces_detected}
Embedding Length: ${result.embedding_length}
Embedding Preview (first 5 values): ${result.embedding_preview}
          `;
        }
      } catch (err) {
        console.error(err);
        resultEl.innerText = "Error sending images or server not reachable";
      }
    });
  </script>
</body>
</html>
